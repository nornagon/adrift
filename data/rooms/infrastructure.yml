- type: roomgen
  name: infrastructure
  algorithm: WFC
  #    Infrastructure hubs serve a variety of purposes.
  #   Some will have equipment racks for a variety of purposes, including:
  #     life support (incl. temperature regulation, gas balance, etc)
  #     intra-ship communications
  #     power systems management
  # There will also typically be some bulky equipment used for those same
  #   activities, (plumbing, water heating, etc) as well as perhaps emergency power generators
  #   or life support gear and other emergency equipment - fire extinguishers, emergency oxygen tanks, etc.
  #   AAdditionally the infrastructure rooms will contain access hatches to the jeffries tubes.
  options:
    parts:
    # Flooring
      - |
        ***
        *.*
        ***
    # Air mixing system
      - max: 2
        part: |
          xxxxxxxx
          .EaAOCC.
          ........
    # Air Temperature Control
      - max: 1
        part: |
         xxxxx
         .hEc.
         *****
    # data / comms equipment
      - max: 3
        part: |
          ....
          .dd.
          .dd.
          ....
    # power system
      - max: 1
        part: |
          ....
          .GP.
          ....
    #waste processing
      - max: 2
        part: |
          xxxxxx
          .wBbw.
          ......
    # Jeffries tube entrance
      - max: 1
        min: 1
        part: |
          ...
          .H.
          ...

    defs:
      .: { terrain: floor }
      x: { terrain: wall }
      E:
        items:
          each:
            - item: atmospheric temperature control system
              connect:
                - { port: Thermostat Command, layer: 0x1 }
                - { port: Heater Enabled, layer: 0x2 }
                - { port: Cooler Enabled, layer: 0x4 }
                - { port: Power, layer: 0x1 }
            #- { item: thermostat, connect: [ { port: Command, layer: 0x1 } ] }
      A: { items: { each: [ air mix system ] } }
      a: { items: { each: [ air purification ] } }
      O: { items: { each: [ {item: oxygen tank} ] } }
      C: { items: { group: gas canister } }
      h:
        items:
          each:
            - item: air heater
              connect:
                - { port: Enabled, layer: 0x2 }
                - { port: Power, layer: 0x1 }
                - { port: Air Out, layer: 0x1 }
      H: { items: { each: [ jeffries hatch] } }
      c: { items: { each: [ { item: air cooler, connect: [ { port: Enabled, layer: 0x4 }, { port: Power, layer: 0x1 }, { port: Air Out, layer: 0x1 } ] } ] } }
      d: { items: { group: data equipment } }
      P: { items: { group: power equipment } }
      G: { items: { each: [ combustion generator ] } }
      B: { items: { each: [ sewage decomposition ] } }
      b: { items: { each: [ water purification ] } }
      w: { items: { each: [ liquid tank ] } }
      "%": { items: rug }

#    connections:
#      - type: power
#        layer: 0x1
#        connect: [G, P]

- type: item
  name: atmospheric temperature control system
  description: A bank of specialized electronic boards for controlling atmospheric temperature. Always wrong somehow.
  display: MEDIUM_EQUIPMENT
  behavior:
    - AdvancedThermostat:
        heaterPort: Heater Enabled
        coolerPort: Cooler Enabled
        setPoint: 275
        hysteresis: 2
    - HasPorts:
        ports:
          - type: data-in
            name: Thermostat Command
          - type: data-out
            name: Heater Enabled
          - type: data-out
            name: Cooler Enabled
          - type: power-in
            name: Power

- type: item
  name: electronics rack
  description: A bank of electronic boards - definitely used to control something important.
  display: MEDIUM_EQUIPMENT
  behavior:
    - HasPorts:
        ports:
          - type: data-in
            name: Input 1 # thermostat command
          - type: data-in
            name: Input 2
          - type: data-in
            name: Input 3
          - type: data-in
            name: Input 4
          - type: data-out
            name: Output 1 # heater enabled
          - type: data-out
            name: Output 2 # cooler enabled
          - type: data-out
            name: Output 3
          - type: data-out
            name: Output 4
          - type: power-in
            name: Power

- type: item
  name: air mix system
  description: keeps the ratios of O2, N2 and CO2 suitable for human and plant life
  display: LARGE_EQUIPMENT

- type: item
  name: air purification
  description: a system for removing a variety of toxins and neutralizing infectious agents from the air
  display: LARGE_EQUIPMENT

- type: item group
  name: gas canister
  choose:
    - oxygen tank
    - CO2 tank
    - nitrogen tank

- type: item
  name: air heater
  description: a bulky unit for dumping large amounts of heat into some air
  display: LARGE_EQUIPMENT
  behavior:
    - Heater: {}
    - ActivatedByDataPort: { portName: Enabled }
    - HasPorts:
        ports:
          - { type: power-in, name: Power }
          - { type: data-in, name: Enabled }
          - { type: fluid-out, name: Air Out }

- type: item
  name: air cooler
  description: a bulky unit which extracts heat from air and stores it for later use in making tea.
  display: LARGE_EQUIPMENT
  behavior:
    - Heater: { dq: -0.5 }
    - ActivatedByDataPort: { portName: Enabled }
    - HasPorts:
        ports:
          - { type: power-in, name: Power }
          - { type: data-in, name: Enabled }
          - { type: fluid-out, name: Air Out }

- type: item
  name: oxygen tank
  description: a big canister for storing and transporting life-giving oxygen.
  display: LARGE_ROD

- type: item
  name: CO2 tank
  description: A canister designed for transporting solid carbon dioxide pellets
  display: LARGE_ROD

- type: item
  name: nitrogen tank
  description: A double-walled vac system for moving liquid nitrogen. Built-in optional gassifier.
  display: LARGE_ROD

- type: item
  name: hydrogen tank
  description: Grown from a crystal seed, this tank can sustain impossible pressures without leaking. It's transparent, so you can see the baby-blue liquid hydrogen inside.
  display: LARGE_ROD

- type: item
  name: combustion generator
  description: A highly efficient combustion generator with automated carbon resequestration.  Feed carbon and oxygen in, get heat and compressed CO2 out.
  parts:
  - { type: C-size frame, count: 1, disassembled_with: SCREWING }
  - { type: fuel hopper, count: 1, disassembled_with: SCREWING }
  - { type: combustion chamber, count: 1, disassembled_with: SCREWING }
  - { type: inverter, count: 1, disassembled_with: SCREWING }
  - { type: CO2 tank, count: 1, disassembled_with: SCREWING }
  - { type: ship power adapter, count: 1, disassembled_with: SCREWING }
  display: MEDIUM_EQUIPMENT
  behavior:
    - GeneratesShipPower: { circuit: main, amountPerTick: 10 }

- type: item
  name: fuel hopper
  description: A port for accepting a wide variety of combustible fuels.
  parts:
    - { type: B-size frame, count: 1, disassembled_with: SCREWING }
    - { type: B-size modular panel, count: 2, disassembled_with: SCREWING }
  display: SMALL_EQUIPMENT

- type: item
  name: combustion chamber
  description: A valved box for combusting fuel to drive a small inverter.
  parts:
    - { type: B-size frame, count: 2, disassembled_with: SCREWING }
    - { type: B-size modular rod, count: 4, disassembled_with: SCREWING }
    - { type: gas valve, count: 2, disassembled_with: SCREWING }
  display: SMALL_EQUIPMENT

- type: item
  name: inverter
  description: Converts motion into POWER.
  parts:
    - { type: A-size frame, count: 1, disassembled_with: SCREWING }
    - { type: insulated wire, count: 1, disassembled_with: SCREWING }
    - { type: B-size modular rod, count: 4, disassembled_with: SCREWING }
    - { type: magnet, count: 3, disassembled_with: SCREWING }
    # wheatstone bridge!
    - { type: micro e-board, count: 1, disassembled_with: SCREWING }
    - { type: flex component, count: 4, disassembled_with: SCREWING }
  display: SMALL_EQUIPMENT

- type: item
  name: gas valve
  description: It can open or close to either permit or prohibit gasses from moving.  Warranty void if exposed to liquids or solids.
  display: SMALL_EQUIPMENT

- type: item
  name: water valve
  description: Operates pretty similar to the one you have equipped for urinary regulation.
  display: SMALL_EQUIPMENT

- type: item group
  name: power equipment
  choose:
    - power cable

- type: item group
  name: data equipment
  choose:
    - {item: flex component, weight: 5}
    - micro e-board

- type: item
  name: water purification
  description: the best way to make sure water is just water is to decompose and recompose it.  Then add in some salts an minerals
  display: LARGE_EQUIPMENT

- type: item
  name: sewage decomposition
  description: laser-catylized reactions break sewage waste down into constituent materials and store it in tanks for reuse
  display: LARGE_EQUIPMENT

- type: item
  name: liquid tank
  description: A large storage tank for some sort of liquid... Could be water? Or maybe it's acid.  Or worse.
  display: LARGE_EQUIPMENT

- type: item
  name: jeffries hatch
  description: A sturily built hatch in the floor.  Access to the maintenance tunnels, probably.
  display: HATCH
  behavior:
    - Affixed: {}
